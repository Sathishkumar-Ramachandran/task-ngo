{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 27, "column": 0}, "map": {"version":3,"sources":["file:///D:/Task/task-ngo/lib/database/client.js"],"sourcesContent":["const sqlite3 = require('sqlite3').verbose();\r\nconst path = require('path');\r\n\r\n// Use process.cwd() to ensure we target the project root in Next.js\r\nconst dbPath = path.resolve(process.cwd(), 'ngo.db');\r\n\r\nconst db = new sqlite3.Database(dbPath, (err) => {\r\n  if (err) {\r\n    console.error('Could not connect to database', err);\r\n  } else {\r\n    console.log('Connected to SQLite database at', dbPath);\r\n  }\r\n});\r\n\r\n// Promisify the query function to match the pg interface\r\nmodule.exports = {\r\n  query: (text, params = []) => {\r\n    return new Promise((resolve, reject) => {\r\n      // SQLite doesn't support $1, $2 syntax natively in the same way as PG for all drivers, \r\n      // but sqlite3 uses ? placeholders. We need to convert or ensure usage matches.\r\n      \r\n      // Simple regex to replace $1, $2... with ?\r\n      const sql = text.replace(/\\$\\d+/g, '?');\r\n\r\n      if (text.trim().toUpperCase().startsWith('SELECT')) {\r\n        db.all(sql, params, (err, rows) => {\r\n          if (err) reject(err);\r\n          else resolve({ rows });\r\n        });\r\n      } else {\r\n        db.run(sql, params, function (err) {\r\n          if (err) reject(err);\r\n          else resolve({ rows: [], rowCount: this.changes });\r\n        });\r\n      }\r\n    });\r\n  }\r\n};\r\n"],"names":[],"mappings":"AAAA,MAAM,UAAU,yEAAmB,OAAO;AAC1C,MAAM;AAEN,oEAAoE;AACpE,MAAM,SAAS,KAAK,OAAO,CAAC,QAAQ,GAAG,IAAI;AAE3C,MAAM,KAAK,IAAI,QAAQ,QAAQ,CAAC,QAAQ,CAAC;IACvC,IAAI,KAAK;QACP,QAAQ,KAAK,CAAC,iCAAiC;IACjD,OAAO;QACL,QAAQ,GAAG,CAAC,mCAAmC;IACjD;AACF;AAEA,yDAAyD;AACzD,OAAO,OAAO,GAAG;IACf,OAAO,CAAC,MAAM,SAAS,EAAE;QACvB,OAAO,IAAI,QAAQ,CAAC,SAAS;YAC3B,wFAAwF;YACxF,+EAA+E;YAE/E,2CAA2C;YAC3C,MAAM,MAAM,KAAK,OAAO,CAAC,UAAU;YAEnC,IAAI,KAAK,IAAI,GAAG,WAAW,GAAG,UAAU,CAAC,WAAW;gBAClD,GAAG,GAAG,CAAC,KAAK,QAAQ,CAAC,KAAK;oBACxB,IAAI,KAAK,OAAO;yBACX,QAAQ;wBAAE;oBAAK;gBACtB;YACF,OAAO;gBACL,GAAG,GAAG,CAAC,KAAK,QAAQ,SAAU,GAAG;oBAC/B,IAAI,KAAK,OAAO;yBACX,QAAQ;wBAAE,MAAM,EAAE;wBAAE,UAAU,IAAI,CAAC,OAAO;oBAAC;gBAClD;YACF;QACF;IACF;AACF"}},
    {"offset": {"line": 68, "column": 0}, "map": {"version":3,"sources":["file:///D:/Task/task-ngo/lib/database/init.js"],"sourcesContent":["const db = require('./client');\r\n\r\nconst initDb = async () => {\r\n  const createTableQuery = `\r\n    CREATE TABLE IF NOT EXISTS reports (\r\n      id INTEGER PRIMARY KEY AUTOINCREMENT,\r\n      ngo_id TEXT NOT NULL,\r\n      month TEXT NOT NULL,\r\n      people_helped INTEGER DEFAULT 0,\r\n      events_conducted INTEGER DEFAULT 0,\r\n      funds_utilized REAL DEFAULT 0,\r\n      created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\r\n      UNIQUE(ngo_id, month)\r\n    );\r\n  `;\r\n\r\n  try {\r\n    await db.query(createTableQuery);\r\n    console.log('Database tables initialized (SQLite)');\r\n  } catch (error) {\r\n    console.error('Error initializing database tables:', error);\r\n  }\r\n};\r\n\r\nmodule.exports = initDb;\r\n"],"names":[],"mappings":"AAAA,MAAM;AAEN,MAAM,SAAS;IACb,MAAM,mBAAmB,CAAC;;;;;;;;;;;EAW1B,CAAC;IAED,IAAI;QACF,MAAM,GAAG,KAAK,CAAC;QACf,QAAQ,GAAG,CAAC;IACd,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,uCAAuC;IACvD;AACF;AAEA,OAAO,OAAO,GAAG"}},
    {"offset": {"line": 94, "column": 0}, "map": {"version":3,"sources":["file:///D:/Task/task-ngo/pages/api/dashboard.js"],"sourcesContent":["import db from '../../lib/database/client';\r\nimport initDb from '../../lib/database/init';\r\n\r\nlet initialized = false;\r\n\r\nexport default async function handler(req, res) {\r\n  if (!initialized) {\r\n    await initDb();\r\n    initialized = true;\r\n  }\r\n\r\n  if (req.method !== 'GET') {\r\n    return res.status(405).json({ error: 'Method not allowed' });\r\n  }\r\n\r\n  try {\r\n    const { month } = req.query;\r\n    let query = `\r\n      SELECT \r\n        COUNT(DISTINCT ngo_id) as total_ngos,\r\n        SUM(people_helped) as total_people_helped,\r\n        SUM(events_conducted) as total_events_conducted,\r\n        SUM(funds_utilized) as total_funds_utilized\r\n      FROM reports\r\n    `;\r\n    \r\n    const params = [];\r\n    if (month) {\r\n      query += ` WHERE month = $1`;\r\n      params.push(month);\r\n    }\r\n\r\n    const result = await db.query(query, params);\r\n    const stats = result.rows[0] || {};\r\n\r\n    res.json({\r\n      totalReports: parseInt(stats.total_ngos || 0),\r\n      totalPeopleHelped: parseInt(stats.total_people_helped || 0),\r\n      totalEventsConducted: parseInt(stats.total_events_conducted || 0),\r\n      totalFundsUtilized: parseFloat(stats.total_funds_utilized || 0),\r\n      month: month || 'All Time'\r\n    });\r\n  } catch (error) {\r\n    console.error(error);\r\n    res.status(500).json({ error: 'Internal Server Error' });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,IAAI,cAAc;AAEH,eAAe,QAAQ,GAAG,EAAE,GAAG;IAC5C,IAAI,CAAC,aAAa;QAChB,MAAM,IAAA,2HAAM;QACZ,cAAc;IAChB;IAEA,IAAI,IAAI,MAAM,KAAK,OAAO;QACxB,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAqB;IAC5D;IAEA,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,GAAG,IAAI,KAAK;QAC3B,IAAI,QAAQ,CAAC;;;;;;;IAOb,CAAC;QAED,MAAM,SAAS,EAAE;QACjB,IAAI,OAAO;YACT,SAAS,CAAC,iBAAiB,CAAC;YAC5B,OAAO,IAAI,CAAC;QACd;QAEA,MAAM,SAAS,MAAM,6HAAE,CAAC,KAAK,CAAC,OAAO;QACrC,MAAM,QAAQ,OAAO,IAAI,CAAC,EAAE,IAAI,CAAC;QAEjC,IAAI,IAAI,CAAC;YACP,cAAc,SAAS,MAAM,UAAU,IAAI;YAC3C,mBAAmB,SAAS,MAAM,mBAAmB,IAAI;YACzD,sBAAsB,SAAS,MAAM,sBAAsB,IAAI;YAC/D,oBAAoB,WAAW,MAAM,oBAAoB,IAAI;YAC7D,OAAO,SAAS;QAClB;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC;QACd,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAwB;IACxD;AACF"}}]
}